import{d as _,a}from"./pinia-e6b04fcb.js";import{S as o}from"./sweetalert2.all-fda0963d.js";import{l as u}from"./loadingStore-abd78020.js";import{r as g}from"./index-f1cc320a.js";const{VITE_APP_URL:s,VITE_APP_PATH:i}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"winter_",BASE_URL:"/the-mountains/",MODE:"production",DEV:!1,PROD:!0},{loadingTrue:d,loadingFalse:n}=u(),P=_("cartStore",{state:()=>({cart:[]}),actions:{addToCart(t,e=1){d();const r={product_id:t,qty:e};a.post(`${s}/api/${i}/cart`,{data:r}).then(f=>{this.getCarts(),o.fire({background:"#0A603C",color:"#FFFFFF",width:350,position:"top-end",showConfirmButton:!1,timer:1e3,title:"加入購物車"}),n()})},getCarts(){d(),a.get(`${s}/api/${i}/cart`).then(t=>{this.isLoading=!1,this.cart=t.data.data,n()})},updateCart(t){d();const e={product_id:t.product_id,qty:t.qty};this.loadingItem=t.id,a.put(`${s}/api/${i}/cart/${t.id}`,{data:e}).then(r=>{this.getCarts(),this.loadingItem="",o.fire({background:"#0A603C",color:"#FFFFFF",width:350,position:"top-end",showConfirmButton:!1,timer:1e3,title:"購物車已更新"}),n()})},deleteCart(t){d(),this.loadingItem=t.id,a.delete(`${s}/api/${i}/cart/${t.id}`).then(e=>{this.getCarts(),this.loadingItem="",o.fire({background:"#b47978",color:"#FFFFFF",width:350,position:"top-end",showConfirmButton:!1,timer:1e3,title:"已刪除"}),n()})},deleteCarts(){d(),a.delete(`${s}/api/${i}/carts`).then(t=>{this.getCarts(),this.loadingItem="",n()})}}}),{VITE_APP_URL:l,VITE_APP_PATH:h}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"winter_",BASE_URL:"/the-mountains/",MODE:"production",DEV:!1,PROD:!0},{loadingTrue:p,loadingFalse:c}=u(),{getCarts:m}=P(),C=_("orderStore",{state:()=>({order:{user:{name:"",email:"",tel:"",address:""},message:""},order_data:{},order_id_data:{},clean:!0}),actions:{payOrder(t){p();const e=`${l}/api/${h}/pay/${t}`;a.post(e).then(r=>{this.getOrder(this.order_id_data.id),o.fire({icon:"success",title:"付款成功"}),c()}).catch(r=>{o.fire({icon:"error",title:r.response.data.message})})},createOrder(){p();const t=`${l}/api/${h}/order`;a.post(t,{data:this.order}).then(e=>{var r;this.order_data=e,this.order={user:{name:"",email:"",tel:"",address:""},message:""},this.getOrder((r=this.order_data.data)==null?void 0:r.orderId),m(),g.push({path:"order"}),c()}).catch(e=>{c(),o.fire({icon:"error",title:e.response.data.message})})},getOrder(t){this.clean=!1,p();const e=`${l}/api/${h}/order/${t}`;a.get(e).then(r=>{this.order_id_data=r.data.order,c(),this.order_id_data||o.fire({icon:"error",title:"訂單不存在"})}).catch(r=>{c(),o.fire({icon:"error",title:r.response})})},cleanOrder(){this.clean=!0}}});export{C as o};
