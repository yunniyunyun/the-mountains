import{d as _,a}from"./pinia-e6b04fcb.js";import{S as o}from"./sweetalert2.all-fda0963d.js";import{l as u}from"./loadingStore-abd78020.js";import{r as g}from"./index-fcea784f.js";const{VITE_APP_URL:s,VITE_APP_PATH:i}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"winter_",BASE_URL:"/the-mountains/",MODE:"production",DEV:!1,PROD:!0},{loadingTrue:d,loadingFalse:n}=u(),P=_("cartStore",{state:()=>({cart:[]}),actions:{addToCart(t,r=1){d();const e={product_id:t,qty:r};a.post(`${s}/api/${i}/cart`,{data:e}).then(m=>{this.getCarts(),o.fire({background:"#0A603C",color:"#FFFFFF",width:350,position:"top-end",showConfirmButton:!1,timer:1e3,title:"加入購物車"}),n()})},toCartPage(t,r=1){d();const e={product_id:t,qty:r};a.post(`${s}/api/${i}/cart`,{data:e}).then(()=>{this.getCarts(),g.push({path:"/cart"}),n()})},getCarts(){d(),a.get(`${s}/api/${i}/cart`).then(t=>{this.isLoading=!1,this.cart=t.data.data,n()})},updateCart(t){d();const r={product_id:t.product_id,qty:t.qty};this.loadingItem=t.id,a.put(`${s}/api/${i}/cart/${t.id}`,{data:r}).then(e=>{this.getCarts(),this.loadingItem="",o.fire({background:"#0A603C",color:"#FFFFFF",width:350,position:"top-end",showConfirmButton:!1,timer:1e3,title:"購物車已更新"}),n()})},deleteCart(t){d(),this.loadingItem=t.id,a.delete(`${s}/api/${i}/cart/${t.id}`).then(r=>{this.getCarts(),this.loadingItem="",o.fire({background:"#b47978",color:"#FFFFFF",width:350,position:"top-end",showConfirmButton:!1,timer:1e3,title:"已刪除"}),n()})},deleteCarts(){d(),a.delete(`${s}/api/${i}/carts`).then(t=>{this.getCarts(),this.loadingItem="",n()})}}}),{VITE_APP_URL:h,VITE_APP_PATH:l}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"winter_",BASE_URL:"/the-mountains/",MODE:"production",DEV:!1,PROD:!0},{loadingTrue:p,loadingFalse:c}=u(),{getCarts:$}=P(),C=_("orderStore",{state:()=>({order:{user:{name:"",email:"",tel:"",address:""},message:""},order_data:{},order_id_data:{}}),actions:{payOrder(t){p();const r=`${h}/api/${l}/pay/${t}`;a.post(r).then(e=>{this.getOrder(this.order_id_data.id),o.fire({icon:"success",title:"付款成功"}),c()}).catch(e=>{o.fire({icon:"error",title:e.response.data.message}),c()})},createOrder(){p();const t=`${h}/api/${l}/order`;a.post(t,{data:this.order}).then(r=>{var e;this.order_data=r,this.order={user:{name:"",email:"",tel:"",address:""},message:""},this.getOrder((e=this.order_data.data)==null?void 0:e.orderId),$(),g.push({path:"order"}),c()}).catch(()=>{c()})},getOrder(t){p();const r=`${h}/api/${l}/order/${t}`;a.get(r).then(e=>{this.order_id_data=e.data.order,c(),this.order_id_data||o.fire({icon:"error",title:"訂單不存在"})}).catch(e=>{c(),o.fire({icon:"error",title:e.response})})}}});export{C as o};
